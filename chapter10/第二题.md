# 关于微服务架构（中台架构、领域驱动设计、组件设计原则），你有什么样的思考和认识？
张彦功

## 微服务架构

1. 实施微服务的前提，业务规模快速发展，研发人员不断增长，单体架构的研发效率跟不上业务的发展
   1. 经历过60+后台研发在一个代码库写代码，发布系统上线一次30+分钟，还是有损发布（小部分请求会失败）
   2. 公共模块、配置，只能让一小部分同学负责，不然冲突不断
   3. 一次上线涉及到多个模块修改，哪怕一个模块出问题，只能全部回滚
   4. 大促期间，系统大概率要挂，只能先拒流量，再恢复服务
2. 刚开始拆分粒度不要太细，每个开发人员负责不超过 3 个大的服务为标准
   1. 先梳理业务/产品能力，确定边界。可以尝试领域驱动设计
   2. 产品、运营、技术都要参与讨论，新的架构设计至少要领先业务半年
3. 纵向拆分：从业务维度进行拆分。如：商品、促销等
4. 横向拆分：从公共且独立功能维度拆分。如：用户中心、权限等
5. 拆分的前置条件
   1. 服务如何定义：服务之间的调用都通过接口描述来约定
   2. 服务如何发布和订阅：引入注册中心
   3. 服务如何监控：业务埋点、数据收集、数据处理，数据展示
   4. 服务如何治理：限流、熔断
   5. 故障如何定位：将一次用户请求进行标记，并在多个依赖的服务系统中继续传递，以便串联所有路径，从而进行故障定位。

