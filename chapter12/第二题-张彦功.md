# 题目2

![image-20200816133254681](/Users/zhangyangong/exp/GitHub/geektime-arch/chapter12/image-20200816133254681.png)

# 解答

## map 函数

1. 输入：page_view、user 的每一个行
   1. 示例：page_view 表 3 行，user 表 2 行
2. 输出：根据 userid 关联的 pv.pageid, u.age 数据
   1. 示例：输出 3 行
   2. 在map的输出value中为不同表的数据打上tag标记，在reduce阶段根据tag判断数据来源

## reduce 函数

1. 输入：map 函数输出的 pv.pageid, u.age
2. 输出：把  pv.pageid, u.age 以覆盖方式写入 pv_users 表中