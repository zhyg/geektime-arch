# 设计一个秒杀系统，主要的挑战和问题有哪些？核心的架构方案或者思路有哪些？

## 挑战和问题

1. 流量的评估
2. 高性能问题
3. 超卖问题
4. 高可用问题
5. 防作弊问题

## 思路

1. 流量的评估
   1. 根据活动的范围、持续时间、优惠的力度、宣传的力度等维度预估UV、PV
   2. 如果之前做过类似的活动，可以用当时的流量乘以一个预估系数
   3. 根据评估，压测系统
2. 高性能问题
   1. 动态数据静态化，提前把静态资源推送到CDN，避免回源
   2. 本地缓存，提前把缓存数据放到本地
   3. 请求和响应数据在不影响基本体验的前提下，尽可能精简
   4. 扩容数据库从库
3. 超卖问题
   1. 下单减库存，超时（如：5分钟）自动释放库存
   2. 在应用层排队（消息队列）
   3. 分布式锁
4. 高可用问题
   1. 秒杀系统独立部署
   2. 消息队列削峰，避免大流量对系统的冲击
   3. 调用第三方系统时，有熔断功能，避免压垮第三方系统
   4. 对上游做限流，一旦超过本系统的处理上限，就拒绝流量
   5. 极端情况，应用层网关下单接口 随机丢弃流量
5. 防作弊问题
   1. 监控应用层网关数据，发现机器人，及时拒绝流量